% !TEX root = ../simfempy.tex
%
%==========================================
\section{Beam problem}\label{sec:}
%==========================================
%
\newcommand{\primitive}[3]{\left[{#1}\right]_{#2}^{#3}}
%
We consider the beam equation with standard boundary conditions. 
Let $\Gamma_C\subset\partial\Omega$, $\Gamma_S\subset\partial\Omega$, and $\Gamma_F\subset\partial\Omega$ be the points where the clamped, simply supported and fixed boundary conditions hold.
%
\begin{equation}\label{eq:beam_strong}
\begin{aligned}
&\frac{d^2}{dx^2} (EI \frac{d^2 w}{dx^2})(x) = q(x)\quad \Omega=]0;L[\\
%
&\left\{
\begin{aligned}
w(x) = \frac{d w}{dx}(x) =& 0 &\quad\mbox{on $\Gamma_C$}&\quad\mbox{(clamped end)}\\
w(x) = \frac{d^2 w}{dx^2}(x) =& 0 &\quad\mbox{on $\Gamma_S$} &\quad\mbox{(simply supported end)}\\
\frac{d^2 w}{dx^2}(x) = \frac{\alpha}{EI},\; \frac{d^3 w}{dx^3}(x) =& \frac{\beta}{EI} &\quad\mbox{on $\Gamma_F$}&\quad\mbox{(free end with forces)}
\end{aligned}
\right.
%
\end{aligned}
\end{equation}
%
%
%
%-------------------------------------------------------------------------
\subsection{Weak formulation}\label{subsec:}
%-------------------------------------------------------------------------
%
Let
%
\begin{equation}\label{eq:beam_V}
H^2_0(\Omega):= \SetDef{v\in H^2(\Omega)}{v(x)=\frac{d v}{dx}(x)=0\;,x\in\partial\Omega}.
\end{equation}
%
be the standard Sobolov space.  
%
For $H^2_0(\Omega) \subset V\subset H^2(\Omega)$ we consider
%
\begin{equation}\label{eq:beam_vareq}
w\in V:\quad \int_{\Omega} EI \frac{d^2 w}{dx^2}\frac{d^2 v}{dx^2}= \int_{\Omega} qv \quad \forall v\in V.
\end{equation}
%
Integration by parts
%
\begin{align*}
\int_{\Omega} EI \frac{d^2 w}{dx^2}\frac{d^2 v}{dx^2}=&-\int_{\Omega}  \frac{d}{dx}(EI \frac{d^2 w}{dx^2})\frac{d v}{dx} + \primitive{EI\frac{d^2 w}{dx^2}\frac{d v}{dx}}{0}{L}\\
=& \int_{\Omega} \frac{d^2}{dx^2}(EI \frac{d^2 w}{dx^2})v + \primitive{EI\frac{d^2 w}{dx^2}\frac{d v}{dx}}{0}{L}- \primitive{EI\frac{d^3 w}{dx^3}v}{0}{L}
\end{align*}
%
shows that a regular solution of (\ref{eq:beam_vareq}) satisfies
%
\begin{align*}
\primitive{EI\frac{d^2 w}{dx^2}\frac{d v}{dx}}{0}{L}- \primitive{EI\frac{d^3 w}{dx^3}v}{0}{L} = 
\int_{\Omega} \left( q - \frac{d^2}{dx^2}(EI \frac{d^2 w}{dx^2})\right)v.
\end{align*}
%
Since $V$ is dense in $L^2(\Omega)$, choosing first $v\in H^2_0(\Omega)$ satisfies $\frac{d^2}{dx^2}(EI \frac{d^2 w}{dx^2})=q$ almost everywhere. Then we have
%
\begin{align*}
\primitive{EI\frac{d^2 w}{dx^2}\frac{d v}{dx}}{0}{L}- \primitive{EI\frac{d^3 w}{dx^3}v}{0}{L} = 0\quad \forall v\in V.
\end{align*}
%
So, depending on the choice of $V$ we have the following possible boundary conditions for $x\in\partial\Omega$:
\begin{center}
\begin{tabular}{c|c|c|c}
&constraint in $V$& strong b.c. & implied b.c.\\\hline
1&$v(x)=\frac{dv}{dx}(x)=0$ & $w(x)=\frac{d w}{dx}(x)=0$ & --\\
2&$v(x)=0$ & $w(x)=0$ & $\frac{d^2 w}{dx^2}=0$\\
3&$\frac{dv}{dx}(x)=0$ & $\frac{dw}{dx}(x)=0$ & $\frac{d^3 w}{dx^3}=0$\\
4&-- & -- & $\frac{d^2 w}{dx^2}=\frac{d^3 w}{dx^3}=0$
\end{tabular}
\end{center}
%
The third case does not seem to be of practical use.
It follows that an appropriate choice for our problem is:
%
\begin{equation}\label{eq:beam_V}
V:= \SetDef{v\in H^2(\Omega)}{v(x_c)=\frac{d v}{dx}(x_c)=0, \quad v(x_s)=0,\quad x_c\in\Gamma_C,x_s\in\Gamma_S}
\end{equation}
%
%
In order to take into account the non-homogenuous boundary condition we define
%
\begin{equation}\label{eq:beam_vareq2}
w\in V:\quad \int_{\Omega} EI \frac{d^2 w}{dx^2}\frac{d^2 v}{dx^2}= \int_{\Omega} qv + 
\delta_{x_f=L}(\alpha\frac{d v}{dx}(L) - \beta v(L)) - \delta_{x_f=0}(\alpha\frac{d v}{dx}(0) - \beta v(0))\quad \forall v\in V.
\end{equation}
%
%
For $a\in L^2(\Omega)$
%---------------------------------------
\begin{proposition}\label{prop:}
(\ref{eq:beam_vareq}) has a unique solution if $\Gamma_C\ne\emptyset$ and the solution satisfies a weak version of 
(\ref{eq:beam_strong}).
\end{proposition}
%---------------------------------------
\begin{proof}
Existence and uniqueness follow from the Lax-Milgram lemma and Poincar√©'s inequality, applied to the function and its derivative.
\end{proof}
%
%
%-------------------------------------------------------------------------
\subsection{Lowest order approximation}\label{subsec:}
%-------------------------------------------------------------------------
%
We use the spaces of quadratic B-splines on a one-dimensional mesh $h:0=x_0<x_1<\cdots< x_N=L$. 
The B-splines are the subspace of quadratic finite elements, which are of class $C^1$, allowing us to use a  
standard finite element basis. 

Let $(\phi_i)_{0\le i\le N}$ be the canonical bases $\Pspace^1_h$ and $\psi_i(x):=\frac{(x-x_{i-1})(x_i-x)}{2h_i^2}$, $1\le i\le N$.
In addition let $h_i:=x_i-x_{i-1}$ and $x_{i-\frac12}:= \frac{x_{i-1}+x_{i}}{2}$, $1\le i\le N$.

Noticing that, with $u'$ the piecewise derivative of $u\in \Pspace^2_h$, we have
%
\begin{equation}\label{eq:beam_C1P2}
u\in C^1(\Omega) 
\quad\Leftrightarrow\quad \sum_{j=1}^{N-1} \jump{u'}\phi(x_j)=0 \quad\forall 1\le i< N,
\quad\Leftrightarrow\quad \int_{\Omega} \left(u'\phi'_i + u''\phi_i\right)=0 \quad\forall 1\le i< N.
\end{equation}
%
Taking into account the condition on the normal derivative in (\ref{eq:beam_V}), we define
%
\begin{equation}\label{eq:beam_Vh}
V_h := \SetDef{v\in \Pspace^2_h}{\int_{\Omega} \left(v'\phi'_i + v''\phi_i\right)=0 \quad\forall 0\le i\le N}\cap H^1_0(\Omega).
\end{equation}
%
and the discrete problem is
%
\begin{equation}\label{eq:beam_varinfh}
w\in V_h:\; \int_{\Omega}EIw''v'' =\int_{\Omega}fv\quad \forall v\in V_h.
\end{equation}
%
Since (\ref{eq:beam_varinfh}) is the optimality condition of energy minimisation, we take into account the constraints defining $V_h$ by a Lagrange multiplier and use the splitting of the space $V_h=V_h^1\times V_h^2$ and $\Lambda_1=V_h^1$
%
\begin{equation}\label{eq:}
w = \sum_{j=0}^N \vec{w_1}_j \phi_j +  \sum_{j=1}^N \vec{w_2}_j \psi_j =: w_1 + w_2,\quad \lambda := \sum_{j=0}^N \vec{\lambda}_j \phi_j.
\end{equation}
%
We notice that
%
\begin{equation}\label{eq:}
v_1''=0\quad\forall v_1\in V_h^1,\quad \int_{\Omega} v_2'\mu'=0\quad\forall v_2\in V_h^2, \mu\in\Lambda_h,
\end{equation}
%
so we arrive at
%
\begin{align*}
(w_1,w_2,\lambda)\in V_h^1\times V_h^2 \times \Lambda_h\\
\left\{
\begin{aligned}
\int_{\Omega}v_1'\lambda' =&\int_{\Omega}fv_1\quad& \forall v_1\in V_h^1,\\
\int_{\Omega}EIw_2''v_2'' +  \int_{\Omega} v_2''\lambda=&\int_{\Omega}fv_2\quad& \forall v_2\in V_h^2,\\
\int_{\Omega} \left(w_1'\mu' + w_2''\mu\right)=&0\quad&\forall \mu\in \Lambda_h.
\end{aligned}
\right.
\end{align*}
%
The boundary conditions correspond to
%
\begin{center}
\begin{tabular}{c|c|c|c}
&b.c.&constraint in $V_h^1$& constraint in $\Lambda_h$\\\hline
1&clamped&$v(x)=0$  & --\\
2&simply supp.&$v(x)=0$ & $\mu(x)=0$ \\
3&unknown&-- & --\\
4&forces&-- & $\mu(x)=0$
\end{tabular}
\end{center}
%
We use again Lagrange multipliers for these constraints. Letting $\mathcal C_V,\mathcal C_{\Lambda}\subset\Set{0,L}$
%
\begin{align*}
D_{ij} = \int_{\Omega} EI\psi_i''\psi''_j,\quad
A_{ij} = \int_{\Omega} \mu_i'\phi'_j,\quad
B_{ij} = \int_{\Omega} \mu_i\psi''_j,\quad
C_{1,ij} = \phi_j(x_i)\; x_i\in\mathcal C_V,\quad
C_{2,ij} = \mu_j(x_i)\; x_i\in\mathcal C_{\Lambda}.
\end{align*}
%
and
%
\begin{align*}
a_i := l(\phi_i), \quad b_i:=l(\psi_i),\quad  c_i = \mu(x_i)\dn{\uD}(x_i),\quad d_i = \phi(x_i)\uD(x_i)
\end{align*}
%

the discrete system reads
%
\begin{equation}\label{eq:}
\begin{bmatrix}
0 & 0 & A& \transpose{C_1}&0\\
0 & D & \transpose{B}& 0&0\\
A & B & 0 & 0&\transpose{C_2}\\
C_1 & 0 & 0 & 0&0\\
0 & 0 & C_2 & 0&0\\
\end{bmatrix}
\begin{bmatrix}
\vec{v_1} \\ \vec{v_2} \\ \vec{\lambda_1}\\ \alpha \\ \beta
\end{bmatrix}
=
\begin{bmatrix}
a \\ b \\ c\\ d\\0
\end{bmatrix},\quad
\end{equation}
%
%
Since $D$ is a regular diagonal matrix we can eliminate $\vec{v_2}$:
%
\begin{align*}
\vec{v_2} = D^{-1}(b-\transpose{B}\vec{\lambda}).
\end{align*}
%

%
\begin{align*}
\begin{bmatrix}
0 & {A}& \transpose{C_1}&0\\
A & X& 0&\transpose{C_2}\\
C_1 & 0  & 0& 0\\
0 & C_2  & 0& 0
\end{bmatrix}
\begin{bmatrix}
\vec{v_1} \\ \vec{\lambda_1}\\ \alpha \\ \beta
\end{bmatrix}
=
\begin{bmatrix}
a  \\ c+ BD^{-1}b\\ d\\0
\end{bmatrix},\quad X:= -BD^{-1}\transpose{B}
\end{align*}
%
We have
%
\begin{align*}
\psi'_i(x)=\frac{(x_{i-\frac12} -x)}{h_i^2},\quad
\psi''_i(x)=\frac{-1}{h_i^2},\\
B_{ii} = \int_{x_{i-1}}^{x_i} \phi_i'\psi'_i+\phi_i\psi''_i = \int_{x_{i-1}}^{x_i} \phi_i\psi''_i = \frac{-1}{2h_i},\quad
B_{i,i+1} = \frac{-1}{2h_{i+1}}, \quad D_{ii} = \frac{EI_i}{h_i^3}\\
%
\left\{
\begin{aligned}
X_{i,i-1} =& \frac{h_i}{4EI_i}\\
X_{i,i} =& \frac{h_i}{4EI_i}+\frac{h_{i+1}}{4EI_{i+1}}\\
X_{i,i+1} =& \frac{h_{i+1}}{4EI_{i+1}}
\end{aligned}
\right.
%
\end{align*}
%

\begin{align*}
\begin{bmatrix}
A & \transpose{B}\\
B & 0
\end{bmatrix}
\begin{bmatrix}
x\\y
\end{bmatrix}
=
\begin{bmatrix}
a  \\ b
\end{bmatrix}
\quad\Rightarrow\quad 
B\transpose{B}y = Ba- BA x
\quad\Rightarrow\quad 
CAx = Ca,\quad C:=I - \transpose{B}\left(B\transpose{B}\right)^{-1}B
\end{align*}


%
%
%==========================================
\printbibliography[title=References Section~\thesection]
%==========================================
